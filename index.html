<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>G·ª≠i Webhook DingTalk</title>
  <style>
    body { font-family: sans-serif; padding: 2em; max-width: 600px; margin: auto; }
    input, textarea { width: 100%; padding: 8px; margin: 8px 0; }
    button { padding: 10px 20px; }
  </style>
</head>
<body>
  <h2>G·ª≠i tin nh·∫Øn ƒë·∫øn Webhook (qua Netlify Function)</h2>
  <label>üîê Webhook URL:</label>
  <input type="text" id="webhookUrl" placeholder="D√°n Webhook URL c·ªßa DingTalk t·∫°i ƒë√¢y">

  <label>‚úâÔ∏è N·ªôi dung:</label>
  <textarea id="message" placeholder="Nh·∫≠p n·ªôi dung c·∫ßn g·ª≠i"></textarea><br>

  <button onclick="send()">G·ª≠i</button>
  <p id="status"></p>

  <script>
    async function send() {
      const url = document.getElementById('webhookUrl').value.trim();
      const msg = document.getElementById('message').value.trim();

      if (!url || !msg) {
        document.getElementById('status').textContent = '‚ö†Ô∏è Nh·∫≠p ƒë·ªß Webhook URL v√† n·ªôi dung.';
        return;
      }

      const res = await fetch('/.netlify/functions/sendMessage', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ webhook: url, message: msg })
      });

      let result;
      try {
        result = await res.json();
      } catch {
        result = { error: "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c ph·∫£n h·ªìi JSON t·ª´ server." };
      }

      document.getElementById('status').textContent =
        res.ok ? '‚úÖ ƒê√£ g·ª≠i th√†nh c√¥ng!' : '‚ùå L·ªói: ' + (result.error || 'Unknown');
    }
  </script>
</body>
</html>
